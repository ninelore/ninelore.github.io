<!doctype html><html>
<head>
<title>Projects</title><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no">
<link rel=stylesheet href=https://ninelore.github.io/assets/css/main.css>
<noscript><link rel=stylesheet href=https://ninelore.github.io/assets/css/noscript.css></noscript><style>:root{--site-background:url("https://ninelore.github.io/images/bg.jpg")}</style><script src=https://identity.netlify.com/v1/netlify-identity-widget.js></script>
</head><body class=is-preload>
<div id=wrapper>
<header id=header>
<div class=logo>
<a href=/>
<span class=icon>
<img src=/pictures/back.png>
</span>
</a>
</div><div class=content>
<div class=inner>
<h1>Projects</h1><p>
My Projects and Guides
</p></div></div><nav>
<ul>
<li>
<a href=#play-arma-on-linux>Play Arma on Linux</a>
</li><li>
<a href=#aaps-terminal-build>AAPS terminal build</a>
</li></ul></nav></header><div id=main>
<article id=aaps-terminal-build>
<h2 class=major>AAPS terminal build</h2><span class="image main"><img src alt></span>
<p>This is a guide on how to build a signed <a href=https://androidaps.readthedocs.io>AndroidAPS</a> APK from a terminal (headless) without Android Studio.<br>
A example usecase for this would be building AAPS via SSH from your phone if you need a new apk for whatever reason while you have no physical access to your PC.</p><p>Note: This Guide is a draft that aims to be integrated into the AAPS Wiki once finished!</p><h2 id=ubuntu-setup>Ubuntu Setup</h2><h3 id=apt-deps>apt Deps:</h3><p>Get these packages from your package manager
<code>sudo apt install wget git openjdk-8-jre-headless openjdk-11-jre-headless zip unzip zipalign gradle</code></p><h3 id=non-pkg-deps>non-pkg Deps:</h3><p>Run these commands to get the Android command line tools</p><pre tabindex=0><code>wget https://dl.google.com/android/repository/commandlinetools-linux-6200805_latest.zip
mkdir android-sdk
unzip commandlinetools-linux-6200805_latest.zip -d $HOME/android-sdk
</code></pre><h3 id=setup-enviromental-variables>Setup Enviromental Variables</h3><p>Add this to your <code>.bashrc</code> if using bash or to the rc file of your shell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export ANDROID_HOME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/android-sdk&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$ANDROID_HOME<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>	PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$ANDROID_HOME<span style=color:#e6db74>/emulator:</span>$ANDROID_HOME<span style=color:#e6db74>/tools:</span>$ANDROID_HOME<span style=color:#e6db74>/tools/bin:</span>$ANDROID_HOME<span style=color:#e6db74>/platform-tools:</span>$PATH<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><p>Restart your Terminal/Shell</p><h3 id=setup-sdk>Setup SDK</h3><p>Run these commands to install the SDK and build tools</p><pre tabindex=0><code>sdkmanager --sdk_root=${ANDROID_HOME} &#34;tools&#34;
sdkmanager --update
sdkmanager &#34;build-tools;28.0.3&#34; &#34;platform-tools&#34; &#34;platforms;android-28&#34; &#34;tools&#34;
sdkmanager --licenses
</code></pre><h2 id=windows-setup>Windows Setup</h2><h3 id=wip>WIP</h3><ul>
<li>install git</li><li>install android sdk tools and stuff</li><li>add both of above to PATH</li></ul><h2 id=build>Build</h2><h3 id=clone-aaps-git>Clone AAPS git</h3><pre tabindex=0><code>git clone https://github.com/nightscout/androidaps.git
cd AndroidAPS
</code></pre><h3 id=build-1>Build</h3><p>Note: Unlike in Android Studio, this will always build both the main apk and the wear apk.</p><pre tabindex=0><code>./gradlew :app:assembleFullRelease
</code></pre><p>The <code>.apk</code>&rsquo;s can be found in:</p><ul>
<li>Main app: <code>app/build/outputs/apk/full/release/app-full-release-unsigned.apk</code></li><li>Wear app: <code>wear/build/outputs/apk/full/release/wear-full-release-unsigned.apk</code></li></ul><h3 id=sign>Sign</h3><h4 id=create-a-single-keystore-file-if-not-done-already>Create a single keystore file if not done already</h4><p>Give it a password, your Name and leave everything else empty. Confirm by typing &ldquo;yes&rdquo;.</p><pre tabindex=0><code>keytool -genkey -v -keystore ~/my-aaps-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias aaps1
</code></pre><h4 id=align-the-apks-and-sign-them>Align the apk&rsquo;s and sign them</h4><pre tabindex=0><code>cd app/build/outputs/apk/full/release/
# align
zipalign -v -p 4 app-full-release-unsigned.apk app-full-release-unsigned-aligned.apk
# sign
apksigner sign --ks ~/my-aaps-key.jks --out app-full-release-signed.apk app-full-release-unsigned-aligned.apk
# (optional) verify successful signing
apksigner verify --verbose app-full-release-signed.apk
</code></pre><h4 id=optional-repeat-align-and-sign-for-wear>(Optional) Repeat align and sign for wear</h4><pre tabindex=0><code>cd wear/build/outputs/apk/full/release/
# align
zipalign -v -p 4 wear-full-release-unsigned.apk wear-full-release-unsigned-aligned.apk
# sign
apksigner sign --ks ~/my-aaps-key.jks --out wear-full-release-signed.apk wear-full-release-unsigned-aligned.apk
# (optional) verify successful signing
apksigner verify --verbose wear-full-release-signed.apk
</code></pre><h2 id=install-app>Install app</h2><p>Copy the apk to your phone via your preferred way and install it.</p></article><article id=play-arma-on-linux>
<h2 class=major>Play Arma on Linux</h2><span class="image main"><img src alt></span>
<h3 id=preamble>Preamble:</h3><p>A few months and improvements to Proton after its first release, i had the first known, good working Arma installation on Linux.</p><p>Since Proton 4.11 as good as all tweaks needed to run Arma became obsolete, and it became as easy as never before to play not only Arma and Steam Games, but also non-Steam games because of many Proton improvements being up streamed to Wine. You can check if your Games are working on the Lutris Website, the WineHQ and the ProtonDB Websites.</p><p>With the release of Proton 6.3-8, the last major burden, BattleEye, is now working and we can play Arma 3 on Linux without <strong>any</strong> restriction!<br>
The only flaw is the non-working original Launcher, which is no problem due to the excellent work of some amazing people that made amazing 3rd-party launchers.</p><p>This new Guide is based on all the knowledge that got collected up until now. This Guide will get continuous Updates</p><p>Last guide update: 2022-02-16 - Proton 7.0 fixes xaudio + misc. typos</p><h3 id=0-disclaimer>0. Disclaimer</h3><p><strong>I don&rsquo;t take any responsibility if any (im)possible damage occurs on your hardware, software or your health, if you lose your job because you were late because your alarm clock didn&rsquo;t ring or if a thermonuclear war breaks out. You are responsible for all changes you are making! Please read everything carefully and if needed twice to prevent misunderstandings. You can contact me via the information provided on my <a href=https://ninelore.github.io>website</a></strong></p><h3 id=1-prepare>1. Prepare</h3><p>You should have</p><ul>
<li>Basic terminal/Bash knowledge</li><li>All software and drivers up to date</li><li>wine-staging (make sure all dependencies are installed)</li><li>For BattleEye: Steam beta client (switch via steam settings)</li></ul><h3 id=2-downloading-arma>2. Downloading Arma</h3><p>Do the following before starting to download Arma!</p><p>Go into Steam settings and then click on &ldquo;Steam Play&rdquo;. Check both boxes and choose the newest Proton version available (not Experimental)
<span class="image fit">
<img src=/pictures/armalinux/steamplaysettings.png alt>
</span>
</p><p>Now go into the Steam game settings menu and add the <code>%command% -nolauncher</code> to the launch options
<span class="image fit">
<img src=/pictures/armalinux/armalaunchoptions.png alt>
</span>
</p><p>Then go into the &ldquo;Compatibility&rdquo; Tab and set the Proton Version again
<span class="image fit">
<img src=/pictures/armalinux/armaprotonversion.png alt>
</span>
</p><p>Now you can start the downlaod of Arma 3.</p><h3 id=3-starting-and-playing-the-game>3. Starting and playing the Game</h3><p>When the download is finished, start the game once and exit it again after reaching the main menu.</p><p>Now you need a Launcher to manage Mods and launch options. I highly recommend using the <a href=https://github.com/muttleyxd/arma3-unix-launcher>Arma 3 Unix Launcher by muttleyxd</a>.<br>
Download: <a href=https://aur.archlinux.org/packages/arma3-unix-launcher-bin>Arch Linux AUR</a> | <a href=https://github.com/muttleyxd/arma3-unix-launcher/releases/latest>as .deb or .AppImage</a></p><p>This is everything you need to play Arma 3 on Linux without ACRE2 or TFAR. Congratulations to get this far. ;)</p><h3 id=4-the-helper-script-and-acre2--tfar>4. The Helper script and ACRE2 / TFAR</h3><h4 id=41-the-helper-script>4.1 The Helper script</h4><p>The Arma3Helper Script (formerly Arma3TS.sh) is reqired to run ACRE2 or TFAR on Linux. It also provides utility to make some Troubleshooting (see Chapter 5) easier.</p><p>Place the <code>Arma3Helper.sh</code> <a href=https://github.com/ninelore/armaonlinux>provided here (click me)</a> in your home directory for easy access.<br>
Edit the file and adjust the settings inside the marked area in that file according to the comments.</p><h4 id=42-preperation-for-acre2--tfar>4.2 Preperation for ACRE2 / TFAR</h4><p>The Arma3Helper script provides a wrapper for winetricks that will set the wineprefix to Arma&rsquo;s compatdata folder after you adjusted the settings inside the script.<br>
To install a variety of DLLs/features that are required for ACRE2 / TFAR as well as fix alot of common issues, run the following command.<br>
<code>./Arma3Helper.sh winetricks Arma</code>
For transparency: The DLLs/features installed are <code>d3dcompiler_43</code>, <code>d3dx10_43</code>, <code>d3dx11_43</code>, <code>mfc140</code> and <code>xact_x64</code>.</p><h4 id=43-acre2--tfar>4.3 ACRE2 / TFAR</h4><p>Download a recent <strong>Windows Installer(!)</strong> of Teamspeak 3.<br>
Install Teamspeak into the compatdata directory of Arma by running <code>./Arma3Helper.sh install path/to/TS3-Installer.exe</code>.<br>
<strong>IMPORTANT: In the Teamspeak Installer, select &ldquo;Install for all Users&rdquo; and leave the default path!!!</strong></p><p>After the Insallation you can start TeamSpeak by just running <code>./Arma3Helper.sh</code> <strong>After you have started Arma</strong>.</p><h3 id=5-troubleshooting>5. Troubleshooting</h3><p>Note: Some troubleshooting steps require the Arma3Helper script. See Chapter 4.1 for more info. Alternatively you can use <a href=https://github.com/Matoking/protontricks>protontricks</a>.</p><h4 id=51-i-have-problems-with-sound-andor-thermal-vision>5.1 I have problems with sound and/or thermal vision</h4><p>See Chapter 4.2</p><h4 id=52-i-still-have-problems-with-sound>5.2 I still have problems with sound</h4><p><strong>IMPORTANT NOTE: This step is obsolete with Proton 7.0</strong><br>
You have 2 options to achieve the same fix.<br>
Either you can set the env variable <code>WINEDLLOVERRIDES="xaudio2_7=n"</code> in the Steam startup options (or via the Arma 3 Unix Launcher).<br>
<span class=image>
<img src=/pictures/armalinux/armalaunchoptions-xaudio.png alt>
</span>
<br>
The other way is to set it via <code>./Arma3Helper.sh winecfg</code> and then under &ldquo;Libraries&rdquo;.<br>
<span class=image>
<img src=/pictures/armalinux/winecfg-xaudio.png alt>
</span>
</p><h4 id=53-arma-doesnt-open-or-crashes-instantly>5.3 Arma doesnt open or crashes instantly</h4><p>Run the following command depending on your linux distro to install possibly missing dependencies<br>
Arch Linux based: <code>sudo pacman -S vulkan-tools</code><br>
Debian/Ubuntu based: <code>sudo apt install mesa-vulkan-drivers vulkan-utils</code><br>
Fedora: <code>sudo dnf install mesa-vulkan-drivers vulkan-tools</code></p><h4 id=54-command-x-returns-error-y>5.4 Command X returns error Y</h4><p>Double check for software and driver updates as well as the spelling of the commands and the settings. If you still got errors continue to Chapter 5.99</p><h4 id=598-use-the-right-linux-distro>5.98 Use the right Linux Distro</h4><p>Note: This is only a recommendation. If you want to stick to distro X then feel free to, however keep in mind that you can run into issues which we cannot be easily solve in Chapter 5.99.</p><p>What I mean by that is <strong>not</strong> something like &ldquo;go Arch&rdquo; or something similar, but to avoid certain kinds of distros that are known to cause problems by their design.<br>
The Distros to avoid are unofficial derivates of Arch Linux, Ubuntu or Debian that are using altered package repositories, as they are known to cause dependency issues (especially if you throw PPA&rsquo;s into the mix) and are generally hard to troubleshoot.<br>
Worst offenders in these terms are (absolutely non-exhaustive):</p><ul>
<li>Arch based: <a href=https://ninelore.github.io/posts/#manjaro-linux-problems>Manjaro</a></li><li>Ubuntu based: Pop! OS, elementaryOS</li></ul><p>Recommended distros are</p><ul>
<li><a href=https://ubuntu.com/desktop>Ubuntu</a> or an <a href=https://ubuntu.com/download/flavours>official flavour</a> (excluding Studio for practical reasons)</li><li>Arch Linux or one of the following derivates that do not touch package repositories
<ul>
<li><a href=https://endeavouros.com/>EndeavourOS</a></li><li><a href=https://garudalinux.org/>Garuda Linux</a></li></ul></li></ul><h4 id=599-i-still-have-a-problem>5.99 I still have a problem</h4><p>More help is available on the <a href=https://discord.gg/p28Ra36>ArmaOnUnix Discord</a></p><h3 id=6-increasing-performance>6. Increasing Performance</h3><h4 id=61-additional-launch-parameters>6.1 Additional Launch Parameters</h4><p>Try a combination of the following to see what works for you the best. Set them as desired via the Arma 3 Unix Launcher or add them to the Steam command line.</p><ul>
<li>
<p><code>-noSplash</code> No splash screens. Very minor game startup speedup.</p></li><li>
<p><code>-skipIntro</code> Static Background for main manu. Minor game startup speedup.</p></li><li>
<p><code>-world=empty</code> Load an empty world for main menu background. Significant game startup speedup.</p></li><li>
<p><code>-exThreads=3</code> for 2 CPU cores or <code>-exThreads=7</code> for 4 cores or more; Offloads some work onto different threads. usually minor FPS Increase</p></li><li>
<p><code>-enableHT</code> enables use of logical cores instead of only physical cores. May improve or harm FPS depending of your PC. Try if it works for you. This is overwritten by <code>-cpuCount</code>.</p></li><li>
<p><code>-hugepages</code> Enable huge page size for memory allocation. Try if it works for you.</p></li><li>
<p><code>-noLogs</code> Not having to write logs may increase performance, but be sure to disable this if you need to troubleshoot problems.</p></li><li>
<p><code>-malloc=&lt;string></code> Use a particular Memory Allocator (for advanced users)(More infos <a href=https://community.bistudio.com/wiki/Arma_3:_Custom_Memory_Allocator>here</a>).</p></li><li>
<p><code>-cpuCount=1</code> Reportedly solves some issure for some people but might decrease performance by a noticable amount. NOTE: This is fixed on the arma perf branch and will find its way into the release branch of Arma soon.</p></li></ul><h4 id=62-general-linux-gaming-optimizations>6.2 General Linux gaming optimizations</h4><p>Note: These Tips aren&rsquo;t exclusive to Arma, but will apply to almost all Linux gaming.</p><ul>
<li>Use a non-standard kernel:
<ul>
<li>Arch Linux oficially supports the <code>linux-zen</code> kernel in its repositories</li><li>Debian / Ubuntu users can try the <a href=https://liquorix.net/>Liquorix</a> or <a href=https://xanmod.org/>XanMod</a> kernels</li><li>Advanced users can build a customized kernel for their system with the help of <a href=https://github.com/Frogging-Family/linux-tkg>linux-tkg</a></li></ul></li><li>Use different desktop enviroment or optimize a slow one:
<ul>
<li>KDE Plasma users can replace <code>kwin</code> with <code>kwin-lowlatency</code></li><li>You might want to switch to a slimmer desktop enviroment like XFCE, LXQt or a bare window manager setup (advanced users)</li></ul></li></ul><h3 id=epilogue>Epilogue</h3><p>This Guide was first released in the <a href="https://armaworld.de/forum/thread/4992-ger-eng-arma-on-linux-ninelore-s-guide-acre-tfar-working/?postID=39909#post39909">Armaworld Forums</a> by me. If you have Feedback or Questions dont hesitate to open a Issue.</p></article></div><footer id=footer>
<p class=copyright>&copy; Design: <a href=https://github.com/d-asnaghi>d-asnaghi</a> and <a href=https://html5up.net>HTML5 UP</a>.</p></footer></div><div id=bg></div></body><script src=https://ninelore.github.io/assets/js/jquery.min.js></script>
<script src=https://ninelore.github.io/assets/js/browser.min.js></script>
<script src=https://ninelore.github.io/assets/js/breakpoints.min.js></script>
<script src=https://ninelore.github.io/assets/js/util.js></script>
<script src=https://ninelore.github.io/assets/js/main.js></script>
</html>